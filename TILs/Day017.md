# 📘 쉘 함수 (function) 흐름 제어

## 🎯 오늘 학습 목표
- 쉘 함수의 정의와 사용 목적 이해
- 함수 인자 전달 방식과 `$1`, `$2`, `$@`의 의미 숙지
- `return`, `exit`, `$?`의 차이점과 활용 방법 정리
- 실무 흐름에서 `main()` 함수 구조의 필요성 이해

---

## 🧠 오늘 배운 개념

### 🔹 함수 정의 및 호출
- `함수명() { ... }` 또는 `function 이름 { ... }` 형식으로 정의
- 호출 시 `함수명 "인자1" "인자2"` 형태로 사용
- 함수 내부에서 `$1`, `$2`, `$@`로 인자 접근 가능

### 🔹 return vs echo vs exit
- `return`: 함수의 결과(상태코드)를 숫자로 반환 (0=성공, 1~255=실패)
- `echo`: 문자열 출력 (스크립트 흐름 제어에 사용 불가)
- `exit`: 스크립트 전체 종료 (실패 시 사용)

### 🔹 상태 코드 확인 변수 `$?`
- 직전 명령어 또는 함수의 상태코드를 저장
- `if [ $? -eq 0 ]; then` 조건에 자주 사용됨

### 🔹 실무 흐름 구조
- 실무에서는 `main()` 함수에서 전체 흐름을 통제
- 기능별로 함수를 정의하고, `main()`에서 호출 순서를 명확히 함
- 조건문이나 `case`문도 함수 내부에 위치시키는 것이 일반적

---

### 🔹 실습 중 사용한 명령어 요약

```
함수명() { ... }      # 함수 정의
return 숫자           # 상태 코드 반환
$?                    # 직전 명령의 결과 확인
exit 숫자             # 스크립트 전체 종료
case "$var" in ...)   # 선택문 분기 처리
read -p "..." var     # 사용자 입력 받기
```

---

## 🧪 실습 과정 요약
1. `login()` 함수에서 ID/PW를 받아 로그인 여부 판단 후 `return`으로 결과 반환
2. `main()` 함수에서 `$?` 상태코드로 로그인 성공 여부 분기
3. 로그인 성공 시 `handle_action()` 함수 호출
4. `handle_action()`에서 사용자의 명령어(start/stop/status)를 받아 `case` 문으로 분기 처리

---

## ⚠️ 실수 & 깨달은 점
- 함수에 `return`을 명확히 주지 않으면, 마지막 명령어의 결과가 상태코드로 전달되어 의도와 다르게 작동함
- `$?`는 항상 직전 명령어의 결과만 저장하므로, 중간에 다른 명령어가 실행되면 값이 바뀜
- `exit`은 스크립트 전체를 종료하기 때문에 반드시 필요한 위치에서만 사용해야 함
- 함수 구조로 정리하니 전체 흐름이 논리적으로 정리되어 실수 방지가 쉬워짐

---

## 💭 느낀 점
오늘은 단순히 함수 문법만 익히는 것이 아니라  
**실무에서 함수를 어떻게 조립하고 상태 흐름을 통제하는지**까지 경험했다.  
`return → $? → if → exit` 흐름을 통해 조건 분기가 명확해졌고,  
`main()` 함수 기반의 구조 설계는 앞으로의 모든 스크립트에 적용하고 싶을 만큼 직관적이었다.
